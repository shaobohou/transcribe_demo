#!/bin/sh
set -eu

if ! command -v uv >/dev/null 2>&1; then
    echo "pre-commit hook: uv not found; install uv to run tests." >&2
    exit 1
fi

if [ -z "${UV_CACHE_DIR:-}" ]; then
    repo_cache="$(pwd)/.uv-cache"
    mkdir -p "$repo_cache"
    export UV_CACHE_DIR="$repo_cache"
fi

echo "pre-commit hook: running uv run python -m pytest"
uv run python -m pytest
